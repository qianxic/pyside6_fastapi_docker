# 遥感影像变化检测系统 - 前端界面

## 项目简介

遥感影像变化检测系统前端是基于PySide6开发的桌面应用程序，提供直观友好的图形用户界面，支持遥感影像的变化检测分析。系统支持图像版和影像版两种工作模式，满足不同应用场景的需求。

## 功能特性

### 🎯 核心功能
- **双模式支持**：图像版（普通图像）和影像版（栅格影像）
- **智能变化检测**：基于AI算法的自动变化识别
- **批量处理**：支持多对影像的批量分析
- **渔网分割**：大尺寸影像的网格化处理

### 🖼️ 图像处理
- **多格式支持**：
  - 图像版：PNG、JPG、JPEG
  - 影像版：TIFF、GeoTIFF、IMG、DEM、HGT
- **可缩放显示**：支持鼠标滚轮缩放、拖拽平移
- **区域选择**：支持图像区域选择功能
- **自动适配**：图像自动适应窗口尺寸

### 🎨 用户界面
- **响应式布局**：四区域设计（前时相、后时相、结果、日志）
- **主题切换**：支持深色/浅色主题
- **实时日志**：处理过程实时显示
- **进度提示**：任务执行进度可视化

### ⚡ 性能优化
- **多线程处理**：避免界面卡顿
- **异步操作**：后台任务执行
- **内存管理**：智能资源释放
- **并发处理**：批量任务并行执行

## 系统架构

```
zhuyaogongneng_docker/
├── app.py                 # 主应用程序入口
├── display.py            # 图像显示和交互模块
├── theme_manager.py      # 主题管理模块
├── function/             # 功能模块目录
│   ├── __init__.py       # 模块初始化
│   ├── batch_processing.py    # 批量处理功能
│   ├── change_cd.py           # 变化检测执行
│   ├── clear_task.py          # 任务清理
│   ├── detection_client.py    # API客户端
│   ├── fishnet_fenge.py       # 渔网分割
│   ├── import_after_image.py  # 后时相导入
│   ├── import_before_image.py # 前时相导入
│   └── image_display.py       # 图像显示管理
└── README.md             # 项目说明文档
```

## 安装部署

### 环境要求
- Python 3.8+
- PySide6
- OpenCV
- NumPy
- PIL (Pillow)

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd zhuyaogongneng_docker
```

2. **安装依赖**
```bash
pip install -r requirements.txt
```

3. **启动应用**
```bash
python app.py
```

### Docker部署
```bash
# 构建镜像
docker build -t rsiis-frontend .

# 运行容器
docker run -it --rm -p 8080:8080 rsiis-frontend
```

## 使用指南

### 基本操作流程

1. **启动系统**
   - 运行应用程序
   - 等待系统初始化完成
   - 选择工作模式（图像版/影像版）

2. **导入影像**
   - 点击"导入前时相影像"选择较早时期的影像
   - 点击"导入后时相影像"选择较新时期的影像
   - 系统自动显示影像预览

3. **执行变化检测**
   - 点击"开始解译"按钮
   - 等待AI算法处理完成
   - 查看解译结果

4. **批量处理**
   - 点击"批量处理"按钮
   - 选择输入目录和输出目录
   - 配置处理参数
   - 启动批量任务

### 高级功能

#### 渔网分割
- 适用于大尺寸影像处理
- 支持自定义网格尺寸
- 自动生成分割后的影像块

#### 主题切换
- 支持深色/浅色主题
- 自动适配所有UI组件
- 提升用户体验

#### 图像交互
- **缩放**：鼠标滚轮缩放图像
- **平移**：拖拽移动图像
- **重置**：双击重置视图
- **选择**：框选图像区域

## API集成

### 后端服务
- 与`change3d_api_docker`模块集成
- 支持RESTful API调用
- 实时状态监控

### 数据格式
```json
{
  "before_path": "前时相影像路径",
  "after_path": "后时相影像路径", 
  "output_path": "输出结果路径",
  "task_id": "任务ID"
}
```

## 配置说明

### 主题配置
```python
# 深色主题
is_dark_theme = True

# 浅色主题  
is_dark_theme = False
```

### 线程池配置
```python
# CPU核心数
CPU_COUNT = multiprocessing.cpu_count()

# 线程池大小
DEFAULT_THREAD_POOL_SIZE = max(1, CPU_COUNT - 1)
```

## 开发指南

### 代码结构
- **模块化设计**：功能模块独立封装
- **接口规范**：统一的API接口定义
- **错误处理**：完善的异常捕获机制

### 扩展开发
1. 在`function/`目录下创建新模块
2. 在`__init__.py`中注册模块
3. 在主界面中添加功能入口
4. 更新主题样式

### 调试模式
```python
# 启用调试日志
logging.basicConfig(level=logging.DEBUG)

# 启用详细错误信息
traceback.print_exc()
```

## 故障排除

### 常见问题

1. **应用启动失败**
   - 检查Python版本（需要3.8+）
   - 确认依赖包安装完整
   - 查看错误日志

2. **图像显示异常**
   - 检查图像文件格式
   - 确认文件路径正确
   - 验证图像文件完整性

3. **处理速度慢**
   - 检查系统资源使用情况
   - 调整线程池大小
   - 优化图像尺寸

4. **API连接失败**
   - 确认后端服务运行状态
   - 检查网络连接
   - 验证API地址配置

### 日志分析
- 系统日志显示在界面右下角
- 详细日志保存在`logs/`目录
- 错误信息包含时间戳和堆栈跟踪

## 版本历史

### v1.0.0 (2024-01-01)
- 初始版本发布
- 基础变化检测功能
- 双模式支持
- 主题系统

### 计划功能
- 更多图像格式支持
- 高级分析工具
- 云端部署支持
- 移动端适配

## 贡献指南

1. Fork项目
2. 创建功能分支
3. 提交代码更改
4. 创建Pull Request

## 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 联系方式

- 项目维护者：qianxiR
- 邮箱：support@rsiis.com
- 项目地址：https://github.com/your-repo/rsiis-frontend

---

**注意**：使用本系统前请确保已正确配置后端API服务，并具备相应的遥感影像数据。
